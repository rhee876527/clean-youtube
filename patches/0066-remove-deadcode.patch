From fc57142641ec087bc4ea9b39c6fa5d3263f01b91 Mon Sep 17 00:00:00 2001
From: Martin Kibera <martin.kibera.n@gmail.com>
Date: Sat, 31 Jan 2026 13:40:17 +0300
Subject: [PATCH] remove deadcode

---
 html/static/js/player.js | 25 +++++++------------------
 1 file changed, 7 insertions(+), 18 deletions(-)

diff --git a/html/static/js/player.js b/html/static/js/player.js
index 6c8a1ea..5345937 100644
--- a/html/static/js/player.js
+++ b/html/static/js/player.js
@@ -257,8 +257,6 @@ document.addEventListener("click", () => {
     pipReady = true;
 });
 
-const audioContext = new AudioContext();
-
 class FormatLoader {
     constructor() {
         this.npv = videoFormats.get(videoElement.getAttribute("data-itag"));
@@ -435,8 +433,6 @@ class QualitySelect extends ElemJS {
 
 new QualitySelect();
 
-const ignoreNext = { play: 0 };
-
 // Throttle media sync
 function throttle(func, delay) {
     let last = 0;
@@ -512,7 +508,7 @@ function playbackIntervention(event) {
     }
 
     // Sync audio for manual seeks
-    if (audioElement.src && !ignoreNext[event.type]--) {
+    if (audioElement.src) {
         if (event.type === "seeked") {
             const targetTime = target.currentTime;
             other.currentTime = targetTime;
@@ -684,14 +680,14 @@ const debouncedPlayVideo = debounce(async () => {
     if (!videoElement.paused) return;
 
     try {
-        if (audioContext.state === 'suspended') await audioContext.resume();
-
-        if (formatLoader.npa) await waitForAudioThenPlay(videoElement, audioElement);
-        else await videoElement.play();
+        if (formatLoader.npa) {
+            await waitForAudioThenPlay(videoElement, audioElement);
+        } else {
+            await videoElement.play();
+        }
     } catch (err) {
         if (err.name === 'AbortError') {
-            // Expected during rapid seeks — silent ignore
-            return;
+            return; // Expected during rapid seeks — silent ignore
         }
         console.error("Playback failed:", err);
     }
@@ -841,14 +837,10 @@ videoElement.setAttribute('preload', 'metadata');
 
 new SubscribeButton(q("#subscribe"));
 
-let userSeeking = false;
-
 // Helper function to seek to timestamp
 async function seekToTimestamp(time, href = null) {
     if (isNaN(time)) return;
 
-    userSeeking = true;
-
     // Set times
     videoElement.currentTime = time;
 
@@ -862,9 +854,6 @@ async function seekToTimestamp(time, href = null) {
     if (href) {
         window.history.replaceState(null, '', href);
     }
-
-    videoElement.addEventListener('seeked', () =>
-        setTimeout(() => userSeeking = false, 300), { once: true });
 }
 
 // Handle clicks on timestamps in page content (descriptions, etc.)
-- 
2.53.0

