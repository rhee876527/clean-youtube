From 77e118b6443616ff884cd52fef6b163b43849168 Mon Sep 17 00:00:00 2001
From: Martin Kibera <martin.kibera.n@gmail.com>
Date: Thu, 30 Oct 2025 18:31:35 +0300
Subject: [PATCH] fix timestamp updating only on refresh after page
 load/chapter click

---
 html/static/js/player.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/html/static/js/player.js b/html/static/js/player.js
index 8446b1d..2f14e49 100644
--- a/html/static/js/player.js
+++ b/html/static/js/player.js
@@ -25,6 +25,14 @@ const audioFormats = [];
     }
 });
 
+// Update src from initial url page load
+try {
+    const src = videoElement.querySelector('source')?.src
+    const itag = videoElement.dataset.itag
+    const vf = itag && videoFormats.get(itag)
+    if (vf && src) vf.url = src
+} catch {}
+
 function getBestAudioFormat() {
     function parseXtags(url) {
         const urlParams = new URLSearchParams(url.split('?')[1] ?? '');
-- 
2.52.0

