From bd3d181eefea9c00ae6ffdb0844e62dabdefcd2e Mon Sep 17 00:00:00 2001
From: Martin Kibera <martin.kibera.n@gmail.com>
Date: Fri, 16 Jan 2026 22:05:00 +0300
Subject: [PATCH] handle exception from comments fetch

---
 api/video.js | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/api/video.js b/api/video.js
index 1457579..1956955 100644
--- a/api/video.js
+++ b/api/video.js
@@ -126,7 +126,13 @@ module.exports = [
 				? request(`${instanceOrigin}/api/v1/videos/${id}`).then(res => res.json())
 				: JSON.parse(new URLSearchParams(body.toString()).get("video"));
 
-			const commentsFuture = request(`${instanceOrigin}/api/v1/comments/${id}`).then(res => res.json());
+			const commentsFuture = request(`${instanceOrigin}/api/v1/comments/${id}`)
+				.then(res => res.json())
+				.catch(err => {
+					console.error("Comments fetch failed:", err.code || err.message);
+					return {comments: []};
+				});
+
 
 			try {
 				const video = await videoFuture;
-- 
2.52.0

